<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>予約フォーム</title>
  <style>
    /* 基本的なスタイル */
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f8f8f8;
      color: #333;
      margin: 0;
      padding: 0;
      
    }
    h1 {
      text-align: center;
      color: #FFF;
      margin-top: 20px;
      background-color: #4CAF50;
      padding: 10px 0;
    }
    .title {
      font-size: 1.6em;
      color: #4CAF50;
      margin-bottom: 10px;
      text-align: center;
    }
    .date-container {
      display: flex;
      flex-direction: column;
      margin-bottom: 20px;
      padding-bottom: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .input-wrapper {
      margin: 10px;
    }
    .input-label {
      font-size: 1.2em;
      margin-bottom: 5px;
      display: block;
    }
    .input-select,
    .input-field,
    .input-textarea {
      font-size: 1em;
      padding: 10px;
      width: 100%;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: #f9f9f9;
      transition: border-color 0.3s ease;
    }
    .input-select:focus,
    .input-field:focus,
    .input-textarea:focus {
      outline: none;
      border-color: #4CAF50;
      background-color: #fff;
    }
    button {
      padding: 12px;
      font-size: 1.5em;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      width: 100%;
      height: 100px;
    }
    button:hover {
      background-color: #45a049;
    }
    #other-input-container {
      display: none;
    }
    #addSecondChoice, #addThirdChoice {
  margin: 10px 0; /* 上下に10pxの余白を追加 */
  height: 60px; /* ボタンの高さを少し小さく */
  font-size: 1.5em; /* フォントサイズを少し小さく */
}
/* スタイリストカードコンテナを横並びに */
#stylist-container {
  display: flex;
  gap: 20px; /* カード間のスペース */
  justify-content: center; /* 横中央揃え */
  flex-wrap: wrap; /* 画面幅が狭い場合に折り返し可能に */
  margin: 20px 0;
}

/* 個々のカードのスタイル */
.stylist-card {
  width: 200px;
  border: 1px solid #ddd;
  border-radius: 10px;
  overflow: hidden;
  text-align: center;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s ease;
  background-color: #fff;
}

.stylist-card:hover {
  transform: translateY(-10px); /* ホバーで浮き上がるエフェクト */
}

/* スタイリスト画像のスタイル */
.stylist-image img {
  width: 100%;
  height: auto;
  border-bottom: 1px solid #ddd;
}

/* スタイリスト情報 */
.stylist-info {
  padding: 10px;
}

.stylist-info h3 {
  margin: 10px 0;
  font-size: 18px;
  color: #333;
}

.stylist-info p {
  margin: 0;
  font-size: 14px;
  color: #666;
}
/* 選択時のカードのスタイル */
.stylist-card.selected {
  border: 2px solid #4CAF50; /* 緑の枠線 */
  box-shadow: 0 8px 10px rgba(0, 0, 0, 0.15);
  background-color: #f9fff9; /* 少し緑がかった背景色 */
}

/* 通常カードのスタイル */
.stylist-card {
  cursor: pointer; /* カーソルをクリック可能に */
  transition: all 0.3s ease;
}

/* 土日を赤く表示 */
.red-day {
  color: red;  /* LIFFのページ内では適用されます */
}

  </style>
  
</head>

<body>
  
  <script src="https://static.line-scdn.net/liff/2.1/sdk.js"></script>
  <h1>OASIS<br>予約希望フォーム</h1>

  <form id="reservationForm">
    <!-- 名前 -->
    <h2 class="title">予約者名</h2>
    <div class="input-wrapper">
      <label for="name" class="input-label">予約者名:</label>
      <input type="text" id="name" name="name" placeholder="オアシス太郎" class="input-field" required><br><br>
    </div>

    <!-- 第1希望 -->
    <h2 class="title">第1希望</h2>
    <div class="date-container">
      <div class="input-wrapper">


      <div class="input-wrapper">
        <label for="day1" class="input-label">日:</label>
        <select id="day1" name="day1" class="input-select" required></select>
      </div>

      <div class="input-wrapper">
        <label for="time1" class="input-label">時間:</label>
        <select id="time1" name="time1" class="input-select" required>
          <!-- 時間の選択肢 -->
          <option value="9:00">9:00</option>
          <option value="10:00">10:00</option>
          <option value="11:00">11:00</option>
          <option value="12:00">12:00</option>
          <option value="13:00">13:00</option>
          <option value="14:00">14:00</option>
          <option value="15:00">15:00</option>
          <option value="16:00">16:00</option>
          <option value="17:00">17:00</option>
          <option value="18:00">18:00</option>
        </select>
      </div>
    </div>

    <!-- 希望2 / 希望3の追加ボタン -->
    <button type="button" id="addSecondChoice">第2希望を追加</button>
    <div id="secondChoice"></div>
    

    

    <button type="button" id="addThirdChoice">第3希望を追加</button>
    <div id="thirdChoice"></div>

<!-- 備考 -->
<h2 class="title">メニュー:</h2>
<div class="input-wrapper">
  <label for="menu" class="input-label">ご希望メニュー</label>
  <textarea id="menu" name="menu" class="input-field" rows="4" placeholder="(例)カットとカラーとトリートメント"></textarea>
</div>


   
<!--スタッフ-->
<h2 class="title">担当スタイリスト:</h2>
<div id="stylist-container">
  <!-- 必ずフォームの中か適切な場所にこの要素を追加 -->
<input type="hidden" id="selectedStylistInput" name="stylist">
<div class="stylist-card" data-stylist="指名なし">
  <div class="stylist-image">
    <img src="LINE_ALBUM_スタッフ写真_241130_1.jpg" alt="指名なし">

  </div>
  <div class="stylist-info">
    <h3>指名なし</h3>
  
  </div>
</div>
<div class="stylist-card" data-stylist="岡崎富之">
    <div class="stylist-image">
      <img src="LINE_ALBUM_スタッフ写真_241130_3.jpg" alt="岡崎富之">
    </div>
    <div class="stylist-info">
      <h3>岡崎富之</h3>
      <p>オーナー</p>
    </div>
  </div>
  <div class="stylist-card" data-stylist="岡崎寿美子">
    <div class="stylist-image">
      <img src="LINE_ALBUM_スタッフ写真_241130_2.jpg" alt="岡崎寿美子">
    </div>
    <div class="stylist-info">
      <h3>岡崎寿美子</h3>
      <p>店長</p>
    </div>
  </div>
</div>





    <!-- 電話番号 -->
    <h2 class="title">電話番号:</h2>
    <div class="input-wrapper">
      <label for="phoneNumber" class="input-label">電話番号:</label>
      <input type="text" id="phoneNumber" class="input-field" placeholder="例: 090-1234-5678 または 09012345678" required>
    </div>

    <!-- 備考 -->
    <h2 class="title">備考:</h2>
    <div class="input-wrapper">
      <label for="comments" class="input-label">ご要望・コメント:</label>
      <textarea id="comments" name="comments" class="input-field" rows="4" placeholder="ご要望があればご記入ください"></textarea>
    </div>

    <!-- 送信ボタン -->
    <button type="submit"id="someButton">予約希望を送信</button>
  </form>

 


  <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/versions/2.22.3/sdk.js"></script>

  <script>
    // LIFF初期化
    liff.init({
      liffId: '2006621786-8K7V4W3M'
    }).then(() => {
      console.log('LIFF initialized');
    }).catch((error) => {
      console.error('LIFF initialization failed:', error);
    });
  
   // 営業する特別な日（祝日など）
const specialWorkingDays = [
  '2024-12-23'  // 例: 12月23日（月曜日）を営業日として追加
];

// 休暇日を追加 (通常の休日)
const holidays = [
  '2024-12-25',  // 休業日
  '2024-01-01'   // 休業日
];

function generateDates() {
  const today = new Date();
  const maxDays = 180;  // 半年分の日付を生成
  const dates = [];
  // 今日の日付を追加
  const formattedToday = `${today.getFullYear()}-${(today.getMonth() + 1)
    .toString()
    .padStart(2, '0')}-${today.getDate().toString().padStart(2, '0')}`;
  const weekdayToday = ["日", "月", "火", "水", "木", "金", "土"][today.getDay()];
  const isWeekendToday = (today.getDay() === 0 || today.getDay() === 6);
  dates.push({
    date: formattedToday,
    weekday: weekdayToday,
    isWeekend: isWeekendToday
  });
  for (let i = 0; i < maxDays; i++) {
    const nextDate = new Date(today);
    nextDate.setDate(today.getDate() + i);

    const dayOfWeek = nextDate.getDay();

    // 月曜日と火曜日は除外
    if (dayOfWeek === 1 || dayOfWeek === 2) continue;

    // 日付をフォーマット
    const formattedDate = `${nextDate.getFullYear()}-${(nextDate.getMonth() + 1)
      .toString()
      .padStart(2, '0')}-${nextDate.getDate().toString().padStart(2, '0')}`;

    // 休暇日リストに含まれていれば、その日をスキップ
    if (holidays.includes(formattedDate)) continue;

    // 曜日を取得
    const weekday = ["日", "月", "火", "水", "木", "金", "土"][nextDate.getDay()];

    // 土日なら赤色をつける
    const isWeekend = (dayOfWeek === 0 || dayOfWeek === 6);  // 日曜日(0)または土曜日(6)
    const dateWithStyle = {
      date: formattedDate,
      weekday: weekday,
      isWeekend: isWeekend
    };

    dates.push(dateWithStyle);
  }

  return dates;
}

function populateDateOptions(selectId) {
  const daySelect = document.getElementById(selectId);
  const dates = generateDates();

  // 既存の選択肢をクリア
  daySelect.innerHTML = '';

  dates.forEach((dateObj, index) => {
    const option = document.createElement('option');
    option.value = dateObj.date;

    // 日付と曜日を適切に表示
    option.textContent = `${dateObj.date} (${dateObj.weekday})`;

    // 土日にはクラス "red-day" を追加
    if (dateObj.isWeekend) {
      option.classList.add('red-day');
    }

    // 初期選択（第1希望のデフォルト選択を今日に設定）
    if (index === 0) {
      option.selected = true;
    }

    daySelect.appendChild(option);
  });
}

  // 名前と電話番号のデータをローカルストレージに保存
  function saveUserData(name, phone) {
    localStorage.setItem('userName', name);
    localStorage.setItem('userPhone', phone);
  }

  // ローカルストレージから名前と電話番号をロード
  function loadUserData() {
    const savedName = localStorage.getItem('userName');
    const savedPhone = localStorage.getItem('userPhone');
    if (savedName) {
      document.getElementById('name').value = savedName;
    }
    if (savedPhone) {
      document.getElementById('phoneNumber').value = savedPhone;
    }
  }

    // 日付更新処理
    function updateDays(monthId, dayId) {
      const month = parseInt(document.getElementById(monthId).value);
      const year = 2024;
      const daysInMonth = new Date(year, month, 0).getDate();
  
      let daysOptions = '';
      for (let i = 1; i <= daysInMonth; i++) {
        daysOptions += `<option value="${i}">${i}日</option>`;
      }
  
      const daysSelect = document.getElementById(dayId);
      daysSelect.innerHTML = daysOptions;
    }
  
    // スタイリスト選択
    document.querySelectorAll('.stylist-card').forEach(card => {
      card.addEventListener('click', () => {
        document.querySelectorAll('.stylist-card').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        document.querySelector('#selectedStylistInput').value = card.dataset.stylist;
      });
    });
  
     // 第2希望の追加
  document.getElementById('addSecondChoice').addEventListener('click', function () {
    const secondChoiceDiv = document.getElementById('secondChoice');
    if (!secondChoiceDiv.innerHTML) {
      secondChoiceDiv.innerHTML = `
        <h2 class="title">第2希望</h2>
        <div class="input-wrapper">
          <label for="day2" class="input-label">日付:</label>
          <select id="day2" name="day2" class="input-select" required></select>
        </div>
        <div class="input-wrapper">
          <label for="time2" class="input-label">時間:</label>
          <select id="time2" name="time2" class="input-select" required>
            ${[...Array(10).keys()].map(i => `<option value="${9 + i}:00">${9 + i}:00</option>`).join('')}
          </select>
        </div>`;
      populateDateOptions('day2');
    } else {
      secondChoiceDiv.innerHTML = '';
    }
  });
  
   // 第3希望の追加
  document.getElementById('addThirdChoice').addEventListener('click', function () {
    const thirdChoiceDiv = document.getElementById('thirdChoice');
    if (!thirdChoiceDiv.innerHTML) {
      thirdChoiceDiv.innerHTML = `
        <h2 class="title">第3希望</h2>
        <div class="input-wrapper">
          <label for="day3" class="input-label">日付:</label>
          <select id="day3" name="day3" class="input-select" required></select>
        </div>
        <div class="input-wrapper">
          <label for="time3" class="input-label">時間:</label>
          <select id="time3" name="time3" class="input-select" required>
            ${[...Array(10).keys()].map(i => `<option value="${9 + i}:00">${9 + i}:00</option>`).join('')}
          </select>
        </div>`;
      populateDateOptions('day3');
    } else {
      thirdChoiceDiv.innerHTML = '';
    }
  });
   // 初期化
   window.onload = function() {
    populateDateOptions('day1');
  };
    // 送信処理
document.getElementById('someButton').addEventListener('click', function (event) {
  event.preventDefault();

  const name = document.getElementById('name')?.value || '';
  const phone = document.getElementById('phoneNumber')?.value || '';

  // 名前と電話番号が未入力の場合のアラート
  if (!name) {
    alert('名前を入力してください');
    return; // 処理を中断
  }
  if (!phone) {
    alert('電話番号を入力してください');
    return; // 処理を中断
  }
  saveUserData(name, phone); // データ保存

const firstChoiceDate = document.getElementById('day1').value;
const firstChoiceTime = document.getElementById('time1').value;
const firstChoiceStylist = document.getElementById('selectedStylistInput').value;

const secondChoiceDate = document.getElementById('day2')?.value || '';
const secondChoiceTime = document.getElementById('time2')?.value || '';
const secondChoiceStylist = document.getElementById('selectedStylistInput')?.value || '';

const thirdChoiceDate = document.getElementById('day3')?.value || '';
const thirdChoiceTime = document.getElementById('time3')?.value || '';
const thirdChoiceStylist = document.getElementById('selectedStylistInput')?.value || '';

const reservationDetails = `
  予約内容:
  名前: ${name}
  電話番号: ${phone}
  第1希望: ${firstChoiceDate} ${firstChoiceTime} ${firstChoiceStylist}
  第2希望: ${secondChoiceDate} ${secondChoiceTime} ${secondChoiceStylist}
  第3希望: ${thirdChoiceDate} ${thirdChoiceTime} ${thirdChoiceStylist}`;

alert(reservationDetails); // 内容確認用のアラートを表示
  const reservation = {
    name: name,
    preferences: ['month1', 'month2', 'month3'].map((monthId, i) => ({
      month: document.getElementById(monthId)?.value || '',
      day: document.getElementById(`day${i + 1}`)?.value || '',
      time: document.getElementById(`time${i + 1}`)?.value || ''
    })).filter(pref => pref.month && pref.day && pref.time),
    menu: document.getElementById('menu').value,
    staff: document.getElementById('selectedStylistInput')?.value || '',
    phone: phone,
    comments: document.getElementById('comments')?.value || ''
  };

  let message = `予約者名: ${reservation.name}\n`;
  reservation.preferences.forEach((pref, index) => {
    const date = new Date(2024, pref.month - 1, pref.day);
    const weekday = ["日", "月", "火", "水", "木", "金", "土"][date.getDay()];
    message += `第${index + 1}希望: ${pref.month}月${pref.day}日 (${weekday}) ${pref.time}\n`;
  });

  message += `メニュー: ${reservation.menu}\n担当スタイリスト: ${reservation.staff}\n電話番号: ${reservation.phone}\nコメント: ${reservation.comments}`;

  liff.sendMessages([{ type: 'text', text: message }])
    .then(() => {
      alert('予約希望が送信されました！');
      liff.closeWindow();
    }).catch(error => {
      alert('エラーが発生しました: ' + error.message);
    });
});

  
    // ページロード時処理
    document.addEventListener('DOMContentLoaded', () => {
      populateDateOptions('day1');
    });
  </script>
  
  
</body>
</html>
